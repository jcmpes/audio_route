<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ruta de la Señal de Audio</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; }
        .stage { margin: 20px; padding: 10px; border: 1px solid #333; display: inline-block; vertical-align: top; }
        .meter-container { display: flex; flex-direction: column-reverse; align-items: center; height: 100px; width: 20px; background: gray; margin: 5px; position: relative; }
        .meter-bar { width: 100%; background: green; height: 10%; transition: height 0.2s; }
        .peak-indicator { position: absolute; top: 0; width: 100%; height: 10%; background: red; opacity: 0; transition: opacity 0.2s; }
        .slider-container { display: flex; flex-direction: column; align-items: center; }
        .vertical-slider { writing-mode: bt-lr; transform: rotate(270deg); }
    </style>
</head>
<body>
    <h2>Ruta de la Señal de Audio</h2>
    
    <div class="stage">Micrófono (-55 dBV)
        <div class="meter-container" id="mic"><div class="meter-bar"></div><div class="peak-indicator"></div></div>
    </div>
    
    <div class="stage">Preamplificador (-10 dBV)
        <div class="slider-container">
            <input type="range" class="vertical-slider" min="-20" max="20" value="0" id="gainPre" oninput="updateMeters()">
        </div>
        <div class="meter-container" id="pre"><div class="meter-bar"></div><div class="peak-indicator"></div></div>
    </div>
    
    <div class="stage">Canal 1 (-10 dBV)
        <div class="slider-container">
            <input type="range" class="vertical-slider fader" min="-20" max="20" value="0" id="gainCanal" oninput="updateMeters()">
        </div>
        <div class="meter-container" id="canal"><div class="meter-bar"></div><div class="peak-indicator"></div></div>
    </div>
    
    <div class="stage">Main Mix (-10 dBV)
        <div class="slider-container">
            <input type="range" class="vertical-slider fader" min="-20" max="20" value="0" id="gainMix" oninput="updateMeters()">
        </div>
        <div class="meter-container" id="mix"><div class="meter-bar"></div><div class="peak-indicator"></div></div>
    </div>
    
    <div class="stage">Entrada PC (-10 dBFS)
        <div class="slider-container">
            <input type="range" class="vertical-slider" min="-20" max="20" value="0" id="gainDigital" oninput="updateMeters()">
        </div>
        <div class="meter-container" id="digital"><div class="meter-bar"></div><div class="peak-indicator"></div></div>
    </div>
    
    <script>
        function updateMeters() {
            let gainPre = parseInt(document.getElementById('gainPre').value) * 6; // Amplificar la ganancia del preamp
            let gainCanal = parseInt(document.getElementById('gainCanal').value) * 0.8;
            let gainMix = parseInt(document.getElementById('gainMix').value) * 0.8;
            let gainDigital = parseInt(document.getElementById('gainDigital').value) * 1.5;
            
            let micLevel = 10; // Nivel base en %
            let preLevel = Math.min(100, Math.max(5, micLevel + gainPre));
            let canalLevel = Math.min(100, Math.max(5, preLevel + gainCanal));
            let mixLevel = Math.min(100, Math.max(5, canalLevel + gainMix));
            let digitalLevel = Math.min(100, Math.max(5, mixLevel + gainDigital));
            
            let levels = { mic: micLevel, pre: preLevel, canal: canalLevel, mix: mixLevel, digital: digitalLevel };
            
            Object.keys(levels).forEach(id => {
                let meterBar = document.getElementById(id).querySelector('.meter-bar');
                let peakIndicator = document.getElementById(id).querySelector('.peak-indicator');
                meterBar.style.height = levels[id] + '%';
                
                if (levels[id] >= 95) {
                    peakIndicator.style.opacity = 1;
                    setTimeout(() => {
                        peakIndicator.style.opacity = 0;
                    }, 1000);
                }
            });
        }
        
        updateMeters();
    </script>
</body>
</html>
